// Generated by Melange
'use strict';

var Curry = require("melange.runtime/curry.js");
var Caml_option = require("melange.runtime/caml_option.js");
var Relude__Relude_Option = require("./Relude_Option.js");

function delay(delayMS, f) {
  var timerId = setTimeout(f, delayMS);
  return function (param) {
    clearTimeout(timerId);
  };
}

function repeat(delayMS, f) {
  var timerId = setInterval(f, delayMS);
  return function (param) {
    clearInterval(timerId);
  };
}

function repeatTimes(delayMS, times, f) {
  var timerId = {
    contents: undefined
  };
  var cancel = function (param) {
    Curry._2(Relude__Relude_Option.forEach, (function (prim) {
            clearInterval(prim);
          }), timerId.contents);
  };
  var callCount = {
    contents: 0
  };
  timerId.contents = Caml_option.some(setInterval((function (param) {
              Curry._1(f, undefined);
              callCount.contents = callCount.contents + 1 | 0;
              if (callCount.contents === times) {
                return cancel(undefined);
              }
              
            }), delayMS));
  return cancel;
}

exports.delay = delay;
exports.repeat = repeat;
exports.repeatTimes = repeatTimes;
/* Relude__Relude_Option Not a pure module */
