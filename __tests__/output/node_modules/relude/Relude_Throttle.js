// Generated by Melange
'use strict';

var Curry = require("melange.runtime/curry.js");
var Caml_option = require("melange.runtime/caml_option.js");
var Relude__Relude_Option = require("./Relude_Option.js");

function throttle(delayMS, leadingOpt, f) {
  var leading = leadingOpt !== undefined ? leadingOpt : false;
  var isThrottled = {
    contents: false
  };
  var timerId = {
    contents: undefined
  };
  var cancel = function (param) {
    Curry._2(Relude__Relude_Option.forEach, (function (timerId) {
            clearTimeout(timerId);
          }), timerId.contents);
    timerId.contents = undefined;
  };
  var isThrottled$1 = function (param) {
    return isThrottled.contents;
  };
  var doLeading = {
    contents: leading
  };
  var throttled = function (param) {
    if (doLeading.contents) {
      doLeading.contents = false;
      return Curry._1(f, undefined);
    } else {
      if (isThrottled.contents) {
        return ;
      } else {
        cancel(undefined);
        isThrottled.contents = true;
        Curry._1(f, undefined);
        timerId.contents = Caml_option.some(setTimeout((function (param) {
                    isThrottled.contents = false;
                    timerId.contents = undefined;
                  }), delayMS));
        return ;
      }
    }
  };
  return {
          cancel: cancel,
          isThrottled: isThrottled$1,
          f: throttled
        };
}

exports.throttle = throttle;
/* Relude__Relude_Option Not a pure module */
